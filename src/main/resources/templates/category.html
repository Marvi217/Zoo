<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:lang="${#locale.language}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${category.name} + ' - PetMarket'">Kategoria - PetMarket</title>
    <link rel="stylesheet" href="/css/public-styles.css">
</head>
<body>
<div th:replace="~{fragments/header :: navbar}"></div>
<div th:replace="~{fragments/header :: categoryBar}"></div>

<!-- BREADCRUMB -->
<div class="breadcrumb">
    <a th:href="@{/}" th:text="#{breadcrumb.home}">Strona g贸wna</a> /
    <span th:text="${category.name}">Kategoria</span>
</div>

<!-- MAIN CONTENT -->
<div class="container">
    <div class="category-header">
        <div>
            <h1 class="category-title" th:text="${category.name}">Kategoria</h1>
            <p class="category-count">
                <span th:text="${#lists.size(products)}">0</span>
                <span th:text="#{category.products}">produkt贸w</span>
            </p>
        </div>

        <!-- SORT OPTIONS -->
        <div class="category-controls">
            <label th:text="#{category.sort}">Sortuj</label>
            <select id="sortSelect" onchange="location = this.value;">
                <option value="?sort=default" th:selected="${currentSort == 'default'}"
                        th:text="#{category.sort.default}">Domylnie</option>
                <option value="?sort=price-asc" th:selected="${currentSort == 'price-asc'}"
                        th:text="#{category.sort.price.asc}">Cena: rosnco</option>
                <option value="?sort=price-desc" th:selected="${currentSort == 'price-desc'}"
                        th:text="#{category.sort.price.desc}">Cena: malejco</option>
                <option value="?sort=name-asc" th:selected="${currentSort == 'name-asc'}"
                        th:text="#{category.sort.name.asc}">Nazwa: A-Z</option>
                <option value="?sort=name-desc" th:selected="${currentSort == 'name-desc'}"
                        th:text="#{category.sort.name.desc}">Nazwa: Z-A</option>
                <option value="?sort=rating" th:selected="${currentSort == 'rating'}"
                        th:text="#{category.sort.rating}">Ocena</option>
            </select>
        </div>
    </div>

    <div class="category-layout">

        <!-- FILTERS SIDEBAR -->
        <aside class="filters-sidebar">
            <h3 class="filter-title" th:text="#{category.filter.brand}">Marka</h3>
            <div class="filter-group">
                <label class="filter-option">
                    <input type="checkbox" name="brand" value="all" checked>
                    <span th:text="#{category.filter.all}">Wszystkie</span>
                </label>
                <label class="filter-option" th:each="brand : ${availableBrands}">
                    <input type="checkbox" name="brand" th:value="${brand.id}">
                    <span th:text="${brand.name}">Marka</span>
                </label>
            </div>

            <h3 class="filter-title" th:text="#{category.filter.price}">Cena</h3>
            <div class="filter-group">
                <input type="range" min="0" max="500" step="10" class="price-range">
                <div class="price-labels">
                    <span>0 <span th:text="#{general.currency}">z</span></span>
                    <span>500 <span th:text="#{general.currency}">z</span></span>
                </div>
            </div>
        </aside>

        <!-- PRODUCTS GRID -->
        <div class="products-section">
            <div th:if="${!products.isEmpty()}" class="products-grid">
                <a th:each="product : ${products}"
                   th:href="@{/product/{id}(id=${product.id})}"
                   class="product-card">

                    <!-- Discount Badge -->
                    <div th:if="${product.hasDiscount}" class="product-badge"
                         th:text="'-' + ${product.discountPercent} + '%'">-25%</div>

                    <div class="product-image" th:text="${product.imageUrl}">Υ</div>

                    <div class="product-info">
                        <h3 class="product-name" th:text="${product.name}">Nazwa produktu</h3>

                        <p class="product-desc" th:text="${product.shortDescription}">Opis produktu</p>

                        <div class="product-footer">
                            <div class="product-pricing">
                                <span class="old-price" th:if="${product.hasDiscount}"
                                      th:text="${#numbers.formatDecimal(product.oldPrice, 1, 2)} + ' ' + #{general.currency}">0.00 z</span>
                                <span class="product-price"
                                      th:text="${#numbers.formatDecimal(product.currentPrice, 1, 2)} + ' ' + #{general.currency}">0.00 z</span>
                            </div>

                            <form th:action="@{/cart/add}" method="post" style="margin: 0;">
                                <input type="hidden" name="productId" th:value="${product.id}">
                                <input type="hidden" name="quantity" value="1">
                                <button type="submit"
                                        class="btn-add-cart"
                                        th:disabled="${!product.available}"
                                        th:text="#{home.add.to.cart}">
                                    Do koszyka
                                </button>
                            </form>
                        </div>
                    </div>
                </a>
            </div>

            <!-- EMPTY STATE -->
            <div th:if="${products.isEmpty()}" class="empty-state">
                <div class="empty-icon"></div>
                <h2 class="empty-title" th:text="#{search.no.results}">Brak wynik贸w</h2>
                <p class="empty-text">Spr贸buj zmieni filtry lub wr贸 do strony g贸wnej</p>
                <a th:href="@{/}" class="btn-primary" th:text="#{breadcrumb.home}">Strona g贸wna</a>
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer>
    <p th:text="#{footer.copyright}">&copy; 2026 PetMarket - Wszystkie prawa zastrze偶one</p>
</footer>

</body>
</html>