<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

<nav th:fragment="navbar" class="navbar">
    <a th:href="@{/}" href="/" class="logo">
        ğŸ¾ <span th:text="#{app.name}">PetMarket</span>
    </a>

    <div class="search-container">
        <form th:action="@{/search}" action="/search" method="get">
            <label>
                <input type="text" name="q" th:placeholder="#{nav.search.placeholder}" placeholder="Szukaj produktÃ³w..." required>
            </label>
            <button type="submit" class="search-btn" th:text="#{nav.search.button}">Szukaj</button>
        </form>
    </div>

    <div class="nav-icons">
        <!-- Link dla zalogowanych uÅ¼ytkownikÃ³w -->
        <a sec:authorize="isAuthenticated()"
           th:href="@{/account}"
           class="nav-link">
            <span style="font-size: 20px;">ğŸ‘¤</span>
            <span th:text="#{nav.account}">Konto</span>
        </a>

        <!-- Link dla niezalogowanych uÅ¼ytkownikÃ³w -->
        <a sec:authorize="!isAuthenticated()"
           th:href="@{/login}"
           class="nav-link">
            <span style="font-size: 20px;">ğŸ‘¤</span>
            <span th:text="#{nav.login}">Zaloguj siÄ™</span>
        </a>

        <a th:href="@{/cart}" class="nav-link">
            <div style="position: relative; display: inline-block;">
                ğŸ›’
                <span class="cart-badge"
                      th:text="${session.cart != null ? session.cart.totalItems : 0}"
                      th:style="${session.cart == null or session.cart.totalItems == 0} ? 'display: none;' : 'display: flex;'">
                    0
                </span>
            </div>
            <span th:text="#{nav.cart}">Koszyk</span>
        </a>
    </div>
</nav>

<!-- CATEGORY BAR FRAGMENT -->
<div th:fragment="categoryBar" class="category-bar" th:if="${globalCategories != null and !#lists.isEmpty(globalCategories)}">
    <a th:each="category : ${globalCategories}"
       th:href="@{/category/{slug}(slug=${category.slug})}"
       class="category-link">
        <span th:text="${category.icon}">ğŸ“¦</span>
        <span th:text="${category.name}">Kategoria</span>
    </a>
</div>

</body>
</html>